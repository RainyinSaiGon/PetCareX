<div class="staff-list-container">
  <div class="header">
    <h2>Qu·∫£n L√Ω Nh√¢n Vi√™n</h2>
    <div class="header-actions">
      <button class="btn btn-primary" routerLink="/admin/staff/new">
        <span class="icon">+</span> Th√™m Nh√¢n Vi√™n
      </button>
      <button class="btn btn-secondary" routerLink="/admin/staff/salary">
         Qu·∫£n L√Ω L∆∞∆°ng & Th·ªëng K√™
      </button>
    </div>
  </div>

  <!-- Filters -->
  <div class="filters-section">
    <div class="filter-row">
      <div class="filter-item search-box">
        <label>T√¨m ki·∫øm</label>
        <input 
          type="text" 
          [(ngModel)]="filter.search" 
          (keyup.enter)="onSearch()"
          placeholder="T√™n, SƒêT, M√£ NV..."
          class="form-control">
        <button class="btn-search" (click)="onSearch()"></button>
      </div>

      <div class="filter-item">
        <label>Chi nh√°nh</label>
        <select [(ngModel)]="filter.maChiNhanh" (change)="onFilterChange()" class="form-control">
          <option value="">T·∫•t c·∫£</option>
          <option *ngFor="let branch of branches" [value]="branch.maChiNhanh">
            {{branch.tenChiNhanh}}
          </option>
        </select>
      </div>

      <div class="filter-item">
        <label>Lo·∫°i nh√¢n vi√™n</label>
        <select [(ngModel)]="filter.loaiNhanVien" (change)="onFilterChange()" class="form-control">
          <option value="">T·∫•t c·∫£</option>
          <option *ngFor="let type of employeeTypes" [value]="type.loaiNhanVien">
            {{type.loaiNhanVien}}
          </option>
        </select>
      </div>

      <div class="filter-item">
        <button class="btn btn-outline" (click)="clearFilters()">X√≥a b·ªô l·ªçc</button>
      </div>
    </div>
  </div>

  <!-- Bulk Actions -->
  <div class="bulk-actions" *ngIf="showBulkActions">
    <div class="bulk-info">
      <strong>{{selectedEmployees.size}}</strong> nh√¢n vi√™n ƒë√£ ch·ªçn
    </div>
    <div class="bulk-controls">
      <select [(ngModel)]="bulkBranch" class="form-control">
        <option value="">Ch·ªçn chi nh√°nh...</option>
        <option *ngFor="let branch of branches" [value]="branch.maChiNhanh">
          {{branch.tenChiNhanh}}
        </option>
      </select>
      <button class="btn btn-primary" (click)="bulkAssignBranch()">Chuy·ªÉn chi nh√°nh</button>
    </div>
  </div>

  <!-- Error Message -->
  <div class="error-message" *ngIf="error">
    {{error}}
  </div>

  <!-- Loading -->
  <div class="loading" *ngIf="loading">
    <div class="spinner"></div>
    <p>ƒêang t·∫£i d·ªØ li·ªáu...</p>
  </div>

  <!-- Employee Table -->
  <div class="table-container" *ngIf="!loading">
    <table class="employee-table">
      <thead>
        <tr>
          <th class="col-id">M√£ NV</th>
          <th class="col-name sortable" (click)="onSortChange('hoTen')">
            H·ªç t√™n {{getSortIcon('hoTen')}}
          </th>
          <th class="col-phone">S·ªë ƒëi·ªán tho·∫°i</th>
          <th class="col-type sortable" (click)="onSortChange('loaiNhanVien')">
            Lo·∫°i NV {{getSortIcon('loaiNhanVien')}}
          </th>
          <th class="col-branch">Chi nh√°nh</th>
          <th class="col-department">Khoa</th>
          <th class="col-salary">L∆∞∆°ng</th>
          <th class="col-date sortable" (click)="onSortChange('ngayVaoLam')">
            Ng√†y v√†o l√†m {{getSortIcon('ngayVaoLam')}}
          </th>
          <th class="col-actions">Thao t√°c</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let employee of employees" [class.selected]="isSelected(employee.MaNhanVien)">
          <td>{{employee.MaNhanVien}}</td>
          <td class="employee-name">
            <strong>{{employee.HoTen}}</strong>
          </td>
          <td>{{employee.SDT}}</td>
          <td>
            <span class="badge badge-type">{{employee.tenLoaiNhanVien || employee.LoaiNhanVien}}</span>
          </td>
          <td>{{employee.tenChiNhanh}}</td>
          <td>{{employee.tenKhoa || '-'}}</td>
          <td class="salary-cell">
            <strong>{{formatCurrency(employee.luongHienTai || 0)}}</strong>
          </td>
          <td>{{formatDate(employee.NgayVaoLam)}}</td>
          <td class="actions-cell">
            <button class="btn-icon" (click)="viewEmployee(employee.MaNhanVien)" title="Xem chi ti·∫øt">
              üëÅÔ∏è
            </button>
            <button class="btn-icon" (click)="editEmployee(employee.MaNhanVien)" title="Ch·ªânh s·ª≠a">
              ‚úèÔ∏è
            </button>
            <button class="btn-icon btn-danger" (click)="deleteEmployee(employee)" title="X√≥a">
              üóëÔ∏è
            </button>
          </td>
        </tr>
        <tr *ngIf="employees.length === 0">
          <td colspan="9" class="empty-state">
            Kh√¥ng t√¨m th·∫•y nh√¢n vi√™n n√†o
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <div class="pagination-container" *ngIf="!loading && employees.length > 0">
    <div class="pagination-info">
      Hi·ªÉn th·ªã {{(filter.page! - 1) * filter.limit! + 1}} - 
      {{Math.min(filter.page! * filter.limit!, totalEmployees)}} 
      trong t·ªïng s·ªë {{totalEmployees}} nh√¢n vi√™n
    </div>

    <div class="pagination-controls">
      <div class="page-size-selector">
        <label>S·ªë d√≤ng:</label>
        <select [(ngModel)]="filter.limit" (change)="onPageSizeChange()" class="form-control">
          <option [value]="10">10</option>
          <option [value]="20">20</option>
          <option [value]="50">50</option>
          <option [value]="100">100</option>
        </select>
      </div>

      <div class="page-buttons">
        <button 
          class="btn-page" 
          (click)="onPageChange(1)" 
          [disabled]="filter.page === 1">
          ‚èÆÔ∏è
        </button>
        <button 
          class="btn-page" 
          (click)="onPageChange(filter.page! - 1)" 
          [disabled]="filter.page === 1">
          ‚óÄÔ∏è
        </button>

        <button 
          *ngFor="let page of getPageNumbers()" 
          class="btn-page" 
          [class.active]="page === filter.page"
          (click)="onPageChange(page)">
          {{page}}
        </button>

        <button 
          class="btn-page" 
          (click)="onPageChange(filter.page! + 1)" 
          [disabled]="filter.page === totalPages">
          ‚ñ∂Ô∏è
        </button>
        <button 
          class="btn-page" 
          (click)="onPageChange(totalPages)" 
          [disabled]="filter.page === totalPages">
          ‚è≠Ô∏è
        </button>
      </div>
    </div>
  </div>
</div>
